import pandas as pd
import random
import time

# ler tabela em excel
df = pd.read_excel('socios1.xlsx')

# selecionar coluna desejada
coluna = df['B']

# criar lista vazia para armazenar os códigos gerados
codigos = []

# percorrer cada linha da coluna
for i in range(len(coluna)):
    
    # criar código fixo nos primeiros 3 dígitos
    codigo = '023'
    
    # verificar valor da linha: se for 1, adicionar 001, se for 2, adicionar 002
    if coluna[i] == 1:
        codigo += '001'
    elif coluna[i] == 2:
        codigo += '002'
    
    # gerar 3 últimos dígitos aleatórios
    random.seed(time.time())
    random_int = random.randint(0, 999)
    random_str = str(random_int).zfill(3)
    
    # concatenar os 3 últimos dígitos ao código
    codigo += random_str
    
    # verificar se o código já foi gerado anteriormente
    while codigo in codigos:
        random.seed(time.time())
        random_int = random.randint(0, 999)
        random_str = str(random_int).zfill(3)
        codigo = codigo[:6] + random_str
    
    # adicionar o código gerado à lista de códigos
    codigos.append(codigo)
    
# criar nova coluna na tabela com os códigos gerados
df['codigo'] = codigos

# salvar tabela com os códigos gerados em um novo arquivo excel
df.to_excel('sociosID.xlsx', index=False)
